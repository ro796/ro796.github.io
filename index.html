<?php
include 'config.php'; // include admin email

if ($_SERVER["REQUEST_METHOD"] == "POST") {
    // check if it's an order or contact message
    if (isset($_POST["cart"])) {
        $to = $admin_email; 
        $subject = "üõí New Order from Moaiad Store";

        $message = "New Order Details:\n\n";
        foreach ($_POST as $key => $value) {
            if ($key == "cart") {
                $cartItems = json_decode($value, true);
                $message .= "Cart:\n";
                foreach ($cartItems as $item) {
                    $message .= "- " . $item["product"] . " : $" . $item["price"] . "\n";
                }
            } else {
                $message .= ucfirst($key) . ": " . $value . "\n";
            }
        }

        mail($to, $subject, $message);
        echo "<h2 style='text-align:center; font-family:Arial'>‚úÖ Order Confirmed! Details sent to admin email</h2>";
        exit;
    } elseif (isset($_POST["contact_message"])) {
        $to = $admin_email;
        $subject = "üì© New Contact Message from Moaiad Store";

        $message = "Message Details:\n\n";
        $message .= "Name: " . $_POST["contact_name"] . "\n";
        $message .= "Email: " . $_POST["contact_email"] . "\n";
        $message .= "Message:\n" . $_POST["contact_message"] . "\n";

        mail($to, $subject, $message);
        echo "<h2 style='text-align:center; font-family:Arial'>‚úÖ Your message has been sent! We'll reply soon.</h2>";
        exit;
    }
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Moaiad Store</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-900">

<!-- Navbar -->
<header class="bg-gray-900 text-white p-4 flex justify-between items-center sticky top-0 z-50">
  <h1 class="text-2xl font-bold">Moaiad Store</h1>
  <nav>
    <button onclick="document.getElementById('products').scrollIntoView({behavior:'smooth'})"
      class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg">Shop Now</button>
    <button onclick="document.getElementById('about').scrollIntoView({behavior:'smooth'})"
      class="bg-purple-500 hover:bg-purple-600 px-4 py-2 rounded-lg ml-2">About Us</button>
    <button onclick="document.getElementById('contact').scrollIntoView({behavior:'smooth'})"
      class="bg-yellow-500 hover:bg-yellow-600 px-4 py-2 rounded-lg ml-2">Contact</button>
    <button onclick="toggleCart()" class="relative ml-4 bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg">
      üõí Cart (<span id="cart-count">0</span>)
    </button>
  </nav>
</header>

<!-- Products -->
<section id="products" class="py-12 px-6">
  <h2 class="text-4xl font-bold text-center mb-12">Our Products</h2>

  <!-- iPhone Covers -->
  <h3 class="text-2xl font-semibold mb-6">iPhone Covers</h3>
  <div class="grid md:grid-cols-3 gap-6 mb-12">
    <div class="bg-white rounded-xl shadow-lg p-4 text-center">
      <img src="https://via.placeholder.com/300" alt="iPhone Cover" class="mx-auto rounded-lg mb-4">
      <h4 class="font-bold">iPhone Cover 1</h4>
      <p class="text-gray-600 mb-2">$150</p>
      <button onclick="addToCart('iPhone Cover 1',150)" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">Add to Cart</button>
    </div>
    <div class="bg-white rounded-xl shadow-lg p-4 text-center">
      <img src="https://via.placeholder.com/300" alt="iPhone Cover" class="mx-auto rounded-lg mb-4">
      <h4 class="font-bold">iPhone Cover 2</h4>
      <p class="text-gray-600 mb-2">$170</p>
      <button onclick="addToCart('iPhone Cover 2',170)" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">Add to Cart</button>
    </div>
  </div>
</section>

<!-- About Us -->
<section id="about" class="py-12 px-6 bg-gray-100">
  <h2 class="text-4xl font-bold text-center mb-6">About Us</h2>
  <p class="text-center max-w-3xl mx-auto text-lg text-gray-700">
    Welcome to <span class="font-bold">Moaiad Store</span> üéâ.  
    We specialize in high-quality phone covers (iPhone, Samsung, and fancy designs) that combine style with protection.  
    Our mission is to provide customers with durable, trendy, and affordable accessories that make their devices stand out.  
  </p>
</section>

<!-- Contact Us -->
<section id="contact" class="py-12 px-6">
  <h2 class="text-4xl font-bold text-center mb-6">Contact Us</h2>
  <form method="POST" class="max-w-xl mx-auto space-y-4 bg-white p-6 rounded-xl shadow-lg">
    <input type="text" name="contact_name" placeholder="Your Name" class="w-full p-2 border rounded" required>
    <input type="email" name="contact_email" placeholder="Your Email" class="w-full p-2 border rounded" required>
    <textarea name="contact_message" placeholder="Your Message" rows="4" class="w-full p-2 border rounded" required></textarea>
    <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg">Send Message</button>
  </form>
</section>

<!-- Footer -->
<footer class="bg-gray-900 text-white text-center py-6 mt-12">
  <p>¬©Ô∏è 2025 Moaiad Store | All Rights Reserved</p>
</footer>

<script>
let cart = [];

function addToCart(product, price) {
  cart.push({product, price});
  updateCart();
  gsap.from("#cart-count", {scale:1.5, duration:0.3, ease:"bounce"});
}

function updateCart() {
  let cartItems = document.getElementById("cart-items");
  let cartTotal = document.getElementById("cart-total");
  let cartCount = document.getElementById("cart-count");
  let cartData = document.getElementById("cart-data");

  cartItems.innerHTML = "";
  let total = 0;
  cart.forEach((item, index) => {
    total += item.price;
    cartItems.innerHTML += `
      <li class="flex justify-between items-center bg-gray-100 px-3 py-2 rounded-lg">
        <span>${item.product} - $${item.price}</span>
        <button onclick="removeFromCart(${index})" class="text-red-600 font-bold">‚úñ</button>
      </li>
    `;
  });
  cartTotal.innerText = total;
  cartCount.innerText = cart.length;
  cartData.value = JSON.stringify(cart);
}

function removeFromCart(index) {
  cart.splice(index,1);
  updateCart();
}

function toggleCart() {
  let cartBox = document.getElementById("cart");
  cartBox.classList.toggle("hidden");
  gsap.from(cartBox, {y:-50, opacity:0, duration:0.5});
}
</script>

<!-- Cart -->
<div id="cart" class="fixed right-6 top-20 w-96 bg-white shadow-2xl rounded-xl p-4 hidden z-50">
  <h3 class="text-xl font-bold mb-4">Your Cart</h3>
  <ul id="cart-items" class="space-y-2 mb-4"></ul>
  <p class="font-bold">Total: $<span id="cart-total">0</span></p>
  
  <!-- Checkout Form -->
  <form method="POST" class="mt-4 space-y-3">
    <input type="hidden" name="cart" id="cart-data">

    <input type="text" name="name" placeholder="Full Name" class="w-full p-2 border rounded" required>
    <input type="email" name="email" placeholder="Email" class="w-full p-2 border rounded" required>
    <input type="text" name="phone" placeholder="Phone Number" class="w-full p-2 border rounded" required>
    <input type="text" name="address" placeholder="Shipping Address" class="w-full p-2 border rounded" required>

    <select name="payment" id="payment-method" class="w-full p-2 border rounded" required>
      <option value="">Select Payment Method</option>
      <option value="Cash on Delivery">Cash on Delivery</option>
      <option value="Visa Card">Visa Card</option>
    </select>

    <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg">Confirm Order</button>
  </form>
</div>

</body>
</html>
